<!DOCTYPE html>
<html lang="fr" class="dark">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Remove AI ‚Äî CPS ¬∑ Nettoyeur de Texte IA</title>
    <meta name="description"
        content="Supprimez les traces IA de votre CV et lettre de motivation. Outil CPS ‚Äî Classe Pr√©pa Scientifique." />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@400;500;600;700&display=swap"
        rel="stylesheet" />
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Space Grotesk', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            50: '#f0eeff',
                            100: '#e0dcff',
                            200: '#c4baff',
                            300: '#a08fff',
                            400: '#7c5fff',
                            500: '#6c3fff',
                            600: '#5a2ee8',
                            700: '#4820c4',
                            800: '#3a189e',
                            900: '#2d1280',
                        },
                        cps: {
                            gold: '#f5a623',
                            blue: '#1a3a6b',
                            light: '#e8f0fe',
                        }
                    },
                    animation: {
                        'spin-slow': 'spin 2s linear infinite',
                        'pulse-fast': 'pulse 0.8s cubic-bezier(0.4,0,0.6,1) infinite',
                        'slide-up': 'slideUp 0.4s ease-out',
                        'fade-in': 'fadeIn 0.5s ease-out',
                        'shimmer': 'shimmer 1.5s infinite',
                        'bar-fill': 'barFill 0.6s cubic-bezier(0.4,0,0.2,1) forwards',
                    },
                    keyframes: {
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        shimmer: {
                            '0%': { backgroundPosition: '-200% 0' },
                            '100%': { backgroundPosition: '200% 0' },
                        },
                        barFill: {
                            '0%': { width: '0%' },
                        },
                    },
                    backgroundImage: {
                        'gradient-radial': 'radial-gradient(var(--tw-gradient-stops))',
                    }
                }
            }
        }
    </script>
    <style>
        /* ‚îÄ‚îÄ THEME VARIABLES ‚îÄ‚îÄ */
        body {
            --bg: #030712;
            --surface: rgba(17, 24, 39, 0.6);
            --surface2: rgba(17, 24, 39, 0.8);
            --border: rgba(31, 41, 55, 1);
            --border2: rgba(55, 65, 81, 0.6);
            --text: #f3f4f6;
            --text-muted: #9ca3af;
            --text-dim: #6b7280;
            --text-dimmer: #4b5563;
            --panel-bg: rgba(17, 24, 39, 0.6);
            --header-bg: rgba(3, 7, 18, 0.8);
            --hero-from: #030712;
            --hero-via: rgba(45, 18, 128, 0.2);
            --score-bg: rgba(31, 41, 55, 1);
            --issues-bg: rgba(17, 24, 39, 0.4);
            --footer-bg: rgba(3, 7, 18, 0.8);
            transition: background-color 0.3s, color 0.3s;
        }

        body.light {
            --bg: #f8fafc;
            --surface: rgba(255, 255, 255, 0.95);
            --surface2: rgba(241, 245, 249, 1);
            --border: rgba(203, 213, 225, 1);
            --border2: rgba(148, 163, 184, 0.5);
            --text: #0f172a;
            --text-muted: #334155;
            --text-dim: #64748b;
            --text-dimmer: #94a3b8;
            --panel-bg: rgba(255, 255, 255, 0.95);
            --header-bg: rgba(248, 250, 252, 0.95);
            --hero-from: #f1f5f9;
            --hero-via: rgba(196, 181, 253, 0.25);
            --score-bg: rgba(203, 213, 225, 1);
            --issues-bg: rgba(241, 245, 249, 1);
            --footer-bg: rgba(241, 245, 249, 1);
        }

        body {
            font-family: 'Inter', sans-serif;
        }

        h1,
        h2,
        h3,
        .font-display {
            font-family: 'Space Grotesk', sans-serif;
        }

        /* Preloader */
        #preloader {
            position: fixed;
            inset: 0;
            z-index: 9999;
            background: #080c14;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 24px;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }

        #preloader.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loader-ring {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            border: 3px solid rgba(108, 63, 255, 0.2);
            border-top-color: #6c3fff;
            animation: spin 0.9s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .loader-dots {
            display: flex;
            gap: 8px;
        }

        .loader-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #6c3fff;
            animation: dotBounce 1.2s ease-in-out infinite;
        }

        .loader-dot:nth-child(2) {
            animation-delay: 0.2s;
            background: #a08fff;
        }

        .loader-dot:nth-child(3) {
            animation-delay: 0.4s;
            background: #f5a623;
        }

        @keyframes dotBounce {

            0%,
            80%,
            100% {
                transform: scale(0.6);
                opacity: 0.5;
            }

            40% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(108, 63, 255, 0.4);
            border-radius: 3px;
        }

        /* Score bar animation */
        .score-bar-fill {
            transition: width 0.7s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Processing overlay */
        #processingOverlay {
            position: absolute;
            inset: 0;
            background: rgba(8, 12, 20, 0.85);
            backdrop-filter: blur(4px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 16px;
            border-radius: 16px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            z-index: 10;
        }

        #processingOverlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .processing-ring {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: 3px solid rgba(108, 63, 255, 0.2);
            border-top-color: #6c3fff;
            animation: spin 0.8s linear infinite;
        }

        /* Shimmer skeleton */
        .shimmer-line {
            background: linear-gradient(90deg, rgba(255, 255, 255, 0.05) 25%, rgba(255, 255, 255, 0.12) 50%, rgba(255, 255, 255, 0.05) 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
            border-radius: 4px;
        }

        /* Tag animation */
        .issue-tag {
            animation: slideUp 0.3s ease-out both;
        }

        /* Gradient text */
        .gradient-text {
            background: linear-gradient(135deg, #a08fff, #6c3fff, #f5a623);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Glow effect */
        .glow-purple {
            box-shadow: 0 0 30px rgba(108, 63, 255, 0.25);
        }

        .glow-gold {
            box-shadow: 0 0 20px rgba(245, 166, 35, 0.2);
        }

        /* Textarea focus */
        textarea:focus {
            outline: none;
        }

        /* Toggle switch */
        .toggle-track {
            width: 44px;
            height: 24px;
            background: rgba(108, 63, 255, 0.3);
            border-radius: 12px;
            position: relative;
            cursor: pointer;
            transition: background 0.3s;
        }

        .toggle-track.on {
            background: #6c3fff;
        }

        .toggle-thumb {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 18px;
            height: 18px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s;
        }

        .toggle-track.on .toggle-thumb {
            transform: translateX(20px);
        }

        /* CPS badge */
        .cps-badge {
            background: linear-gradient(135deg, #1a3a6b, #2a5298);
            border: 1px solid rgba(245, 166, 35, 0.4);
        }
    </style>
</head>

<body class="min-h-screen" style="background-color:var(--bg);color:var(--text)">

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     PRELOADER
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="preloader">
        <div class="text-center mb-2">
            <div class="flex items-center justify-center gap-3 mb-4">
                <div
                    class="w-10 h-10 rounded-xl bg-gradient-to-br from-brand-500 to-brand-700 flex items-center justify-center text-xl shadow-lg">
                    üßπ</div>
                <div>
                    <div class="font-display font-bold text-xl gradient-text">Remove AI</div>
                    <div class="text-xs text-gray-500">by CPS</div>
                </div>
            </div>
            <div class="loader-ring mx-auto mb-4"></div>
            <div class="loader-dots justify-center flex">
                <div class="loader-dot"></div>
                <div class="loader-dot"></div>
                <div class="loader-dot"></div>
            </div>
        </div>
        <p class="text-gray-500 text-sm" id="preloaderMsg">Chargement du moteur de nettoyage‚Ä¶</p>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     HEADER
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <header class="sticky top-0 z-50 backdrop-blur-xl"
        style="background:var(--header-bg);border-bottom:1px solid var(--border)">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 py-3 flex items-center justify-between gap-4">
            <!-- Logo -->
            <div class="flex items-center gap-3">
                <div
                    class="w-9 h-9 rounded-xl bg-gradient-to-br from-brand-500 to-brand-700 flex items-center justify-center text-lg shadow-lg glow-purple flex-shrink-0">
                    üßπ</div>
                <div>
                    <div class="flex items-center gap-2">
                        <h1 class="font-display font-bold text-lg gradient-text leading-none">Remove AI</h1>
                        <span class="cps-badge text-xs font-semibold px-2 py-0.5 rounded-full text-cps-gold">CPS</span>
                    </div>
                    <p class="text-xs leading-none mt-0.5 hidden sm:block" style="color:var(--text-muted)">Nettoyeur de
                        traces IA ¬∑ CV & Lettre de motivation</p>
                </div>
            </div>

            <!-- Actions -->
            <div class="flex items-center gap-3">
                <!-- Timer display -->
                <div id="timerBadge" class="hidden items-center gap-1.5 rounded-lg px-3 py-1.5 text-xs"
                    style="background:var(--surface);border:1px solid var(--border);color:var(--text-muted)">
                    <span class="text-brand-400">‚ö°</span>
                    Traitement : <span id="timerVal" class="font-mono font-semibold"
                        style="color:var(--text)">0ms</span>
                </div>
                <!-- Theme toggle -->
                <div class="flex items-center gap-2 text-xs" style="color:var(--text-muted)">
                    <span>üåô</span>
                    <div class="toggle-track on" id="themeToggle" onclick="toggleTheme()">
                        <div class="toggle-thumb"></div>
                    </div>
                    <span>‚òÄÔ∏è</span>
                </div>
            </div>
        </div>
    </header>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     HERO BANNER
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="relative overflow-hidden"
        style="background:linear-gradient(135deg,var(--hero-from),var(--hero-via),var(--hero-from));border-bottom:1px solid var(--border)">
        <!-- Background glow -->
        <div class="absolute inset-0 overflow-hidden pointer-events-none">
            <div class="absolute -top-20 -left-20 w-96 h-96 bg-brand-600/10 rounded-full blur-3xl"></div>
            <div class="absolute -top-10 right-0 w-72 h-72 bg-cps-gold/5 rounded-full blur-3xl"></div>
        </div>
        <div class="relative max-w-7xl mx-auto px-4 sm:px-6 py-6 sm:py-8">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
                <div>
                    <h2 class="font-display font-bold text-2xl sm:text-3xl mb-1" style="color:var(--text)">
                        Passez le filtre des recruteurs üéØ
                    </h2>
                    <p class="text-sm sm:text-base max-w-xl" style="color:var(--text-muted)">
                        Collez votre texte IA ‚Üí l'outil supprime le markdown, les m√©tadonn√©es et les tics de langage des
                        LLMs pour rendre votre texte ind√©tectable.
                    </p>
                </div>
                <div class="flex flex-wrap gap-2 flex-shrink-0">
                    <a href="https://www.zerogpt.com" target="_blank"
                        class="detector-link flex items-center gap-1.5 rounded-lg px-3 py-2 text-xs transition-all"
                        style="background:var(--surface);border:1px solid var(--border);color:var(--text-muted)">üîç
                        ZeroGPT</a>
                    <a href="https://gptzero.me" target="_blank"
                        class="detector-link flex items-center gap-1.5 rounded-lg px-3 py-2 text-xs transition-all"
                        style="background:var(--surface);border:1px solid var(--border);color:var(--text-muted)">üîç
                        GPTZero</a>
                    <a href="https://copyleaks.com" target="_blank"
                        class="detector-link flex items-center gap-1.5 rounded-lg px-3 py-2 text-xs transition-all"
                        style="background:var(--surface);border:1px solid var(--border);color:var(--text-muted)">üîç
                        Copyleaks</a>
                </div>
            </div>

            <!-- Stats row -->
            <div class="flex flex-wrap gap-3 mt-5">
                <div class="flex items-center gap-2 rounded-xl px-4 py-2.5 backdrop-blur-sm"
                    style="background:var(--surface);border:1px solid var(--border)">
                    <span class="text-yellow-400 text-lg">üìù</span>
                    <div>
                        <div class="text-xs" style="color:var(--text-muted)">Markdown supprim√©</div>
                        <div class="font-display font-bold text-lg leading-none" style="color:var(--text)" id="statMd">0
                        </div>
                    </div>
                </div>
                <div class="flex items-center gap-2 rounded-xl px-4 py-2.5 backdrop-blur-sm"
                    style="background:var(--surface);border:1px solid var(--border)">
                    <span class="text-pink-400 text-lg">ü§ñ</span>
                    <div>
                        <div class="text-xs" style="color:var(--text-muted)">Phrases IA retir√©es</div>
                        <div class="font-display font-bold text-lg leading-none" style="color:var(--text)" id="statAi">0
                        </div>
                    </div>
                </div>
                <div class="flex items-center gap-2 rounded-xl px-4 py-2.5 backdrop-blur-sm"
                    style="background:var(--surface);border:1px solid var(--border)">
                    <span class="text-brand-400 text-lg">‚úÇÔ∏è</span>
                    <div>
                        <div class="text-xs" style="color:var(--text-muted)">Caract√®res nettoy√©s</div>
                        <div class="font-display font-bold text-lg leading-none" style="color:var(--text)"
                            id="statChars">0</div>
                    </div>
                </div>
                <div class="flex items-center gap-2 rounded-xl px-4 py-2.5 backdrop-blur-sm"
                    style="background:var(--surface);border:1px solid var(--border)">
                    <span class="text-green-400 text-lg">üìä</span>
                    <div>
                        <div class="text-xs" style="color:var(--text-muted)">Mots dans le r√©sultat</div>
                        <div class="font-display font-bold text-lg leading-none" style="color:var(--text)"
                            id="statWords">0</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     SCORE METERS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 py-4">
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <!-- Before -->
            <div class="rounded-2xl p-4 backdrop-blur-sm"
                style="background:var(--panel-bg);border:1px solid var(--border)">
                <div class="flex items-center justify-between mb-3">
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 rounded-full bg-red-500 animate-pulse"></div>
                        <span class="text-xs font-semibold uppercase tracking-wider"
                            style="color:var(--text-muted)">Score IA ‚Äî Original</span>
                    </div>
                    <span class="font-display font-bold text-xl" style="color:var(--text)" id="scoreBeforeVal">‚Äî</span>
                </div>
                <div class="h-2.5 rounded-full overflow-hidden" style="background:var(--score-bg)">
                    <div id="scoreBefore"
                        class="score-bar-fill h-full rounded-full bg-gradient-to-r from-yellow-500 to-red-500"
                        style="width:0%"></div>
                </div>
                <div class="flex justify-between mt-1.5 text-xs" style="color:var(--text-dimmer)">
                    <span>Humain üë§</span><span>IA ü§ñ</span>
                </div>
            </div>
            <!-- After -->
            <div class="rounded-2xl p-4 backdrop-blur-sm"
                style="background:var(--panel-bg);border:1px solid var(--border)">
                <div class="flex items-center justify-between mb-3">
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 rounded-full bg-green-500"></div>
                        <span class="text-xs font-semibold uppercase tracking-wider"
                            style="color:var(--text-muted)">Score IA ‚Äî Nettoy√©</span>
                    </div>
                    <span class="font-display font-bold text-xl" style="color:var(--text)" id="scoreAfterVal">‚Äî</span>
                </div>
                <div class="h-2.5 rounded-full overflow-hidden" style="background:var(--score-bg)">
                    <div id="scoreAfter"
                        class="score-bar-fill h-full rounded-full bg-gradient-to-r from-green-500 to-emerald-400"
                        style="width:0%"></div>
                </div>
                <div class="flex justify-between mt-1.5 text-xs" style="color:var(--text-dimmer)">
                    <span>Humain üë§</span><span>IA ü§ñ</span>
                </div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     MAIN PANELS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 pb-6">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-5">

            <!-- ‚îÄ‚îÄ INPUT PANEL ‚îÄ‚îÄ -->
            <div class="flex flex-col rounded-2xl overflow-hidden backdrop-blur-sm"
                style="min-height:480px;background:var(--panel-bg);border:1px solid var(--border)">
                <div class="flex items-center justify-between px-4 py-3"
                    style="border-bottom:1px solid var(--border);background:var(--surface2)">
                    <div class="flex items-center gap-2">
                        <span class="text-base">üìã</span>
                        <span class="text-xs font-semibold uppercase tracking-wider"
                            style="color:var(--text-muted)">Texte original</span>
                        <span class="text-xs" style="color:var(--text-dim)" id="inputCharCount">0 car.</span>
                    </div>
                    <button onclick="clearInput()"
                        class="flex items-center gap-1.5 text-xs text-red-400 hover:text-red-300 bg-red-500/10 hover:bg-red-500/20 border border-red-500/20 rounded-lg px-3 py-1.5 transition-all">
                        üóë Effacer
                    </button>
                </div>
                <textarea id="inputText"
                    class="flex-1 w-full bg-transparent text-sm leading-relaxed p-5 resize-none focus:ring-0 border-0"
                    style="color:var(--text);"
                    placeholder="Collez ici votre texte g√©n√©r√© par une IA (ChatGPT, Claude, Gemini‚Ä¶)&#10;&#10;Le nettoyage se fait automatiquement en temps r√©el.&#10;&#10;Exemples de ce qui sera supprim√© :&#10;‚Ä¢ **Texte en gras** ‚Üí Texte en gras&#10;‚Ä¢ Certainly! Of course! ‚Üí (supprim√©)&#10;‚Ä¢ In conclusion, ‚Üí (supprim√©)&#10;‚Ä¢ # Titre ‚Üí Titre&#10;‚Ä¢ ‚Äî tirets longs ‚Üí -"
                    oninput="onInput()" onpaste="setTimeout(onInput, 10)"></textarea>
            </div>

            <!-- ‚îÄ‚îÄ OUTPUT PANEL ‚îÄ‚îÄ -->
            <div class="flex flex-col rounded-2xl overflow-hidden backdrop-blur-sm relative"
                style="min-height:480px;background:var(--panel-bg);border:1px solid var(--border)">
                <!-- Processing overlay -->
                <div id="processingOverlay">
                    <div class="processing-ring"></div>
                    <p class="text-sm" style="color:var(--text-muted)">Nettoyage en cours‚Ä¶</p>
                    <div class="flex gap-2">
                        <div class="shimmer-line w-24 h-2"></div>
                        <div class="shimmer-line w-16 h-2"></div>
                        <div class="shimmer-line w-20 h-2"></div>
                    </div>
                </div>

                <div class="flex items-center justify-between px-4 py-3"
                    style="border-bottom:1px solid var(--border);background:var(--surface2)">
                    <div class="flex items-center gap-2">
                        <span class="text-base">‚ú®</span>
                        <span class="text-xs font-semibold uppercase tracking-wider"
                            style="color:var(--text-muted)">Texte nettoy√©</span>
                        <span class="text-xs" style="color:var(--text-dim)" id="outputCharCount">0 car.</span>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="copyOutput()"
                            class="flex items-center gap-1.5 text-xs font-semibold text-white bg-gradient-to-r from-brand-600 to-brand-500 hover:from-brand-500 hover:to-brand-400 rounded-lg px-3 py-1.5 transition-all shadow-lg shadow-brand-900/50">
                            ‚úÖ Tout copier
                        </button>
                    </div>
                </div>

                <!-- Output content -->
                <div id="outputText"
                    class="flex-1 p-5 text-sm leading-relaxed overflow-y-auto whitespace-pre-wrap break-words"
                    style="color:var(--text)">
                    <!-- Empty state -->
                    <div id="emptyState" class="h-full flex flex-col items-center justify-center gap-3 text-center">
                        <div class="text-5xl opacity-20">üßπ</div>
                        <p class="text-sm" style="color:var(--text-dim)">Le texte nettoy√© appara√Ætra ici‚Ä¶</p>
                        <p class="text-xs" style="color:var(--text-dimmer)">Collez votre texte dans le panneau de gauche
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     DETECTED ISSUES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 pb-8">
        <div class="rounded-2xl p-4" style="background:var(--issues-bg);border:1px solid var(--border)">
            <div class="flex items-center gap-2 mb-3">
                <span class="text-sm">üîç</span>
                <h3 class="text-xs font-semibold uppercase tracking-wider" style="color:var(--text-muted)">√âl√©ments
                    d√©tect√©s et supprim√©s</h3>
            </div>
            <div class="flex flex-wrap gap-2" id="issuesGrid">
                <div class="text-xs italic" style="color:var(--text-dim)">Collez un texte pour voir l'analyse d√©taill√©e‚Ä¶
                </div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     FOOTER
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <footer style="border-top:1px solid var(--border);background:var(--footer-bg)">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 py-5 flex flex-col sm:flex-row items-center justify-between gap-3">
            <div class="flex items-center gap-3">
                <div class="cps-badge rounded-lg px-3 py-1.5 flex items-center gap-2">
                    <span class="text-cps-gold font-display font-bold text-sm">CPS</span>
                    <span class="text-xs" style="color:rgba(255,255,255,0.85)">Classe Pr√©pa Scientifique</span>
                </div>

            </div>
            <div class="flex items-center gap-3 text-xs" style="color:var(--text-dim)">
                <span>Testez sur :</span>
                <a href="https://www.zerogpt.com" target="_blank"
                    class="text-brand-400 hover:text-brand-300 transition-colors">ZeroGPT</a>
                <a href="https://gptzero.me" target="_blank"
                    class="text-brand-400 hover:text-brand-300 transition-colors">GPTZero</a>
                <a href="https://copyleaks.com" target="_blank"
                    class="text-brand-400 hover:text-brand-300 transition-colors">Copyleaks</a>
            </div>
        </div>
        <div class="text-center py-2 text-xs" style="border-top:1px solid var(--border);color:var(--text-dimmer)">
            remove-ai by <span class="font-semibold gradient-text">Ziw Baby</span>
        </div>
    </footer>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     WELCOME MODAL
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="welcomeOverlay" class="fixed inset-0 z-[200] flex items-center justify-center p-4"
        style="display:none!important">
        <!-- Backdrop -->
        <div class="absolute inset-0" style="background:rgba(3,7,18,0.85);backdrop-filter:blur(12px)"></div>

        <!-- Particles -->
        <div id="particles" class="absolute inset-0 overflow-hidden pointer-events-none"></div>

        <!-- Card -->
        <div id="welcomeCard" class="relative z-10 w-full max-w-md rounded-3xl p-8 shadow-2xl"
            style="background:linear-gradient(135deg,rgba(30,20,80,0.95),rgba(17,24,39,0.98));border:1px solid rgba(108,63,255,0.3);box-shadow:0 0 60px rgba(108,63,255,0.2),0 25px 50px rgba(0,0,0,0.5);animation:welcomeIn 0.6s cubic-bezier(0.34,1.56,0.64,1) forwards">

            <!-- Top glow -->
            <div class="absolute -top-16 left-1/2 -translate-x-1/2 w-48 h-48 rounded-full pointer-events-none"
                style="background:radial-gradient(circle,rgba(108,63,255,0.4),transparent 70%)"></div>

            <!-- Icon -->
            <div class="flex justify-center mb-5">
                <div class="w-20 h-20 rounded-2xl flex items-center justify-center text-4xl shadow-lg"
                    style="background:linear-gradient(135deg,#6c3fff,#a08fff);box-shadow:0 8px 32px rgba(108,63,255,0.5)">
                    üéì
                </div>
            </div>

            <!-- Title -->
            <div class="text-center mb-2">
                <h2 class="font-display font-bold text-2xl text-white">Bienvenue sur <span class="gradient-text">Remove
                        AI</span></h2>
                <p class="text-sm mt-1" style="color:#9ca3af">L'outil CPS pour passer les filtres IA üöÄ</p>
            </div>

            <!-- Divider -->
            <div class="my-5 h-px"
                style="background:linear-gradient(90deg,transparent,rgba(108,63,255,0.5),transparent)"></div>

            <!-- Form -->
            <div class="space-y-4">
                <div>
                    <label class="block text-xs font-semibold uppercase tracking-wider mb-2" style="color:#a08fff">üë§
                        Ton pr√©nom</label>
                    <input id="inputNom" type="text" placeholder="Ex : Amadou"
                        class="w-full rounded-xl px-4 py-3 text-sm font-medium outline-none transition-all"
                        style="background:rgba(255,255,255,0.07);border:1px solid rgba(108,63,255,0.3);color:#f3f4f6;caret-color:#a08fff"
                        onfocus="this.style.borderColor='rgba(108,63,255,0.8)';this.style.boxShadow='0 0 0 3px rgba(108,63,255,0.15)'"
                        onblur="this.style.borderColor='rgba(108,63,255,0.3)';this.style.boxShadow='none'" />
                </div>
                <div>
                    <label class="block text-xs font-semibold uppercase tracking-wider mb-2" style="color:#a08fff">üè´ Ta
                        promo</label>
                    <select id="inputPromo"
                        class="w-full rounded-xl px-4 py-3 text-sm font-medium outline-none transition-all cursor-pointer"
                        style="background:rgba(255,255,255,0.07);border:1px solid rgba(108,63,255,0.3);color:#f3f4f6"
                        onfocus="this.style.borderColor='rgba(108,63,255,0.8)'"
                        onblur="this.style.borderColor='rgba(108,63,255,0.3)'">
                        <option value="" style="background:#1a1040">-- S√©lectionne ta promo --</option>
                        <option value="CPS 2024" style="background:#1a1040">CPS 2024</option>
                        <option value="CPS 2025" style="background:#1a1040">CPS 2025</option>
                        <option value="CPS 2026" style="background:#1a1040">CPS 2026</option>
                        <option value="CPS 2027" style="background:#1a1040">CPS 2027</option>
                        <option value="Autre" style="background:#1a1040">Autre</option>
                    </select>
                </div>
            </div>

            <!-- CTA -->
            <button onclick="saveStudent()"
                class="mt-6 w-full py-3.5 rounded-xl font-display font-bold text-white text-sm tracking-wide transition-all duration-200 hover:scale-[1.02] active:scale-[0.98]"
                style="background:linear-gradient(135deg,#6c3fff,#a08fff);box-shadow:0 4px 20px rgba(108,63,255,0.4)">
                ‚ú® Acc√©der √† l'outil
            </button>

            <!-- Footer note -->
            <p class="text-center text-xs mt-4" style="color:#4b5563">Tes donn√©es restent sur ton appareil uniquement
            </p>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     GREETING BANNER
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="greetingBanner"
        class="hidden fixed top-0 left-0 right-0 z-[100] flex items-center justify-center py-2 text-sm font-medium"
        style="background:linear-gradient(90deg,rgba(108,63,255,0.15),rgba(160,143,255,0.1),rgba(108,63,255,0.15));border-bottom:1px solid rgba(108,63,255,0.2);backdrop-filter:blur(8px)">
        <span id="greetingText" style="color:#c4baff"></span>
        <button onclick="document.getElementById('greetingBanner').classList.add('hidden')"
            class="ml-3 text-xs opacity-40 hover:opacity-80 transition-opacity" style="color:#9ca3af">‚úï</button>
    </div>


    <div id="toast"
        class="fixed bottom-6 right-6 z-50 flex items-center gap-2 bg-green-500 text-gray-950 font-semibold text-sm px-4 py-3 rounded-xl shadow-2xl shadow-green-900/50 translate-y-20 opacity-0 transition-all duration-300">
        ‚úÖ Copi√© dans le presse-papier !
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     JAVASCRIPT ENGINE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <script>
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        //  PRELOADER
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        const preloaderMessages = [
            'Chargement du moteur de nettoyage‚Ä¶',
            'Compilation des r√®gles markdown‚Ä¶',
            'Indexation des phrases IA‚Ä¶',
            'Calibration du score heuristique‚Ä¶',
            'Pr√™t !'
        ];
        let msgIdx = 0;
        const msgEl = document.getElementById('preloaderMsg');
        const msgInterval = setInterval(() => {
            msgIdx++;
            if (msgIdx < preloaderMessages.length) {
                msgEl.textContent = preloaderMessages[msgIdx];
            } else {
                clearInterval(msgInterval);
            }
        }, 300);

        window.addEventListener('load', () => {
            setTimeout(() => {
                document.getElementById('preloader').classList.add('hidden');
            }, 1600);
        });

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        //  MARKDOWN RULES
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        const markdownRules = [
            { name: 'Bloc de code (```)', re: /```[\s\S]*?```/g, replace: '' },
            { name: 'Code inline (`)', re: /`([^`]+)`/g, replace: '$1' },
            { name: 'Titres Markdown (#)', re: /^#{1,6}\s+(.+)$/gm, replace: '$1' },
            { name: 'Gras+Italique (***)', re: /\*{3}(.+?)\*{3}/g, replace: '$1' },
            { name: 'Gras (**)', re: /\*{2}(.+?)\*{2}/g, replace: '$1' },
            { name: 'Gras (__)', re: /__(.+?)__/g, replace: '$1' },
            { name: 'Italique (*)', re: /\*(.+?)\*/g, replace: '$1' },
            { name: 'Italique (_)', re: /_(.+?)_/g, replace: '$1' },
            { name: 'Barr√© (~~)', re: /~~(.+?)~~/g, replace: '$1' },
            { name: 'Citation (>)', re: /^>\s?/gm, replace: '' },
            { name: 'S√©parateur (---)', re: /^[-*_]{3,}\s*$/gm, replace: '' },
            { name: 'Liste √† puces', re: /^[\s]*[-*+]\s+/gm, replace: '' },
            { name: 'Liste num√©rot√©e', re: /^[\s]*\d+\.\s+/gm, replace: '' },
            { name: 'Liens Markdown []()', re: /\[([^\]]+)\]\([^)]+\)/g, replace: '$1' },
            { name: 'Images Markdown ![]()', re: /!\[[^\]]*\]\([^)]+\)/g, replace: '' },
            { name: 'S√©parateur tableau', re: /^\|[-| :]+\|$/gm, replace: '' },
            { name: 'Tableaux Markdown (|)', re: /^\|.+\|$/gm, replace: (m) => m.replace(/\|/g, ' ').trim() },
            { name: 'Balises HTML', re: /<\/?[a-zA-Z][^>]*>/g, replace: '' },
        ];

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        //  AI PHRASE RULES
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        const aiPhraseRules = [
            // Affirmations
            { name: 'Certainly!', re: /\bCertainly[!,]?\s*/gi, replace: '' },
            { name: 'Of course!', re: /\bOf course[!,]?\s*/gi, replace: '' },
            { name: 'Absolutely!', re: /\bAbsolutely[!,]?\s*/gi, replace: '' },
            { name: 'Sure!', re: /\bSure[!,]?\s*/gi, replace: '' },
            { name: 'Great!', re: /\bGreat[!,]?\s*/gi, replace: '' },
            { name: 'Bien s√ªr !', re: /\bBien s√ªr\s*[!,]?\s*/gi, replace: '' },
            { name: 'Bien entendu', re: /\bBien entendu\s*[!,]?\s*/gi, replace: '' },
            { name: "D'accord !", re: /\bD['']accord\s*[!,]?\s*/gi, replace: '' },
            { name: 'Parfait !', re: /\bParfait\s*[!,]?\s*/gi, replace: '' },
            { name: 'Absolument !', re: /\bAbsolument\s*[!,]?\s*/gi, replace: '' },
            { name: "Je serais ravi(e) de", re: /\bJe\s+serais\s+ravi[e]?\s+de\b/gi, replace: 'Je vais' },
            { name: "I'd be happy to", re: /\bI['']d\s+be\s+happy\s+to\b/gi, replace: 'I will' },
            { name: "I'd be glad to", re: /\bI['']d\s+be\s+glad\s+to\b/gi, replace: 'I will' },
            { name: "I'd be delighted to", re: /\bI['']d\s+be\s+delighted\s+to\b/gi, replace: 'I will' },
            // Meta-commentary
            { name: 'As an AI', re: /\bAs an AI[^,.]*(,|\.|\s)/gi, replace: '' },
            { name: "En tant qu'IA", re: /\bEn tant qu['']IA[^,.]*[,.]\s*/gi, replace: '' },
            { name: 'As a language model', re: /\bAs a language model[^,.]*(,|\.|\s)/gi, replace: '' },
            { name: "It's worth noting", re: /\bIt['']s worth noting that\b/gi, replace: '' },
            { name: 'Il est important de noter', re: /\bIl est important de noter que\b/gi, replace: '' },
            { name: 'It is important to note', re: /\bIt is important to note that\b/gi, replace: '' },
            { name: 'It is worth mentioning', re: /\bIt is worth mentioning that\b/gi, replace: '' },
            { name: 'Please note that', re: /\bPlease note that\b/gi, replace: '' },
            { name: 'It should be noted', re: /\bIt should be noted that\b/gi, replace: '' },
            { name: 'Notez que', re: /\bNotez que\b/gi, replace: '' },
            { name: 'Il convient de noter', re: /\bIl convient de noter que\b/gi, replace: '' },
            { name: 'Il est √† noter', re: /\bIl est √† noter que\b/gi, replace: '' },
            // Transitions
            { name: 'In conclusion,', re: /\bIn conclusion[,.]?\s*/gi, replace: '' },
            { name: 'En conclusion,', re: /\bEn conclusion[,.]?\s*/gi, replace: '' },
            { name: 'In summary,', re: /\bIn summary[,.]?\s*/gi, replace: '' },
            { name: 'En r√©sum√©,', re: /\bEn r√©sum√©[,.]?\s*/gi, replace: '' },
            { name: 'To summarize,', re: /\bTo summarize[,.]?\s*/gi, replace: '' },
            { name: 'In short,', re: /\bIn short[,.]?\s*/gi, replace: '' },
            { name: 'To sum up,', re: /\bTo sum up[,.]?\s*/gi, replace: '' },
            { name: 'Overall,', re: /\bOverall[,.]?\s*/gi, replace: '' },
            { name: 'Furthermore,', re: /\bFurthermore[,.]?\s*/gi, replace: '' },
            { name: 'Moreover,', re: /\bMoreover[,.]?\s*/gi, replace: '' },
            { name: 'Additionally,', re: /\bAdditionally[,.]?\s*/gi, replace: '' },
            { name: 'In addition,', re: /\bIn addition[,.]?\s*/gi, replace: '' },
            { name: 'Nevertheless,', re: /\bNevertheless[,.]?\s*/gi, replace: '' },
            { name: 'Nonetheless,', re: /\bNonetheless[,.]?\s*/gi, replace: '' },
            { name: 'Consequently,', re: /\bConsequently[,.]?\s*/gi, replace: '' },
            { name: 'Therefore,', re: /\bTherefore[,.]?\s*/gi, replace: '' },
            { name: 'Thus,', re: /\bThus[,.]?\s*/gi, replace: '' },
            { name: 'Hence,', re: /\bHence[,.]?\s*/gi, replace: '' },
            { name: 'Accordingly,', re: /\bAccordingly[,.]?\s*/gi, replace: '' },
            { name: 'As a result,', re: /\bAs a result[,.]?\s*/gi, replace: '' },
            { name: 'Par cons√©quent,', re: /\bPar cons√©quent[,.]?\s*/gi, replace: '' },
            { name: 'De plus,', re: /\bDe plus[,.]?\s*/gi, replace: '' },
            { name: 'En outre,', re: /\bEn outre[,.]?\s*/gi, replace: '' },
            { name: 'Cependant,', re: /\bCependant[,.]?\s*/gi, replace: '' },
            { name: 'N√©anmoins,', re: /\bN√©anmoins[,.]?\s*/gi, replace: '' },
            { name: 'Toutefois,', re: /\bToutefois[,.]?\s*/gi, replace: '' },
            { name: 'Ainsi,', re: /\bAinsi[,.]?\s*/gi, replace: '' },
            { name: 'D√®s lors,', re: /\bD√®s lors[,.]?\s*/gi, replace: '' },
            // Clich√©s IA
            { name: "In today's world", re: /\bIn today['']s (world|society|landscape)[,.]?\s*/gi, replace: '' },
            { name: 'Dans le monde actuel', re: /\bDans le monde actuel[,.]?\s*/gi, replace: '' },
            { name: 'In the ever-evolving', re: /\bIn the ever-evolving\b/gi, replace: 'In the' },
            { name: 'As previously mentioned', re: /\bAs (previously|earlier) mentioned[,.]?\s*/gi, replace: '' },
            { name: 'Comme mentionn√© pr√©c√©demment', re: /\bComme mentionn√© pr√©c√©demment[,.]?\s*/gi, replace: '' },
            { name: 'It goes without saying', re: /\bIt goes without saying that\b/gi, replace: '' },
            { name: 'Needless to say', re: /\bNeedless to say[,.]?\s*/gi, replace: '' },
            { name: 'Last but not least', re: /\bLast but not least[,.]?\s*/gi, replace: '' },
            { name: 'First and foremost', re: /\bFirst and foremost[,.]?\s*/gi, replace: '' },
            { name: 'Without further ado', re: /\bWithout further ado[,.]?\s*/gi, replace: '' },
            { name: 'I hope this helps', re: /\bI hope this (helps|clarifies|answers)[^.]*\./gi, replace: '' },
            { name: 'Feel free to', re: /\bFeel free to\b/gi, replace: 'You can' },
            { name: "Don't hesitate to", re: /\bDon['']t hesitate to\b/gi, replace: 'Please' },
            { name: "N'h√©sitez pas √†", re: /\bN['']h√©sitez pas √†\b/gi, replace: 'Vous pouvez' },
            { name: 'Je me tiens √† votre disposition', re: /\bJe me tiens √† votre disposition\b/gi, replace: 'Je suis disponible' },
        ];

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        //  CHARACTER RULES
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        const charRules = [
            { name: 'Espaces invisibles', re: /[\u200B\u200C\u200D\uFEFF\u00AD]/g, replace: '' },
            { name: 'Guillemets typographiques', re: /[\u201C\u201D]/g, replace: '"' },
            { name: 'Apostrophes typographiques', re: /[\u2018\u2019]/g, replace: "'" },
            { name: 'Tiret long (‚Äî)', re: /\u2014/g, replace: ' - ' },
            { name: 'Tiret moyen (‚Äì)', re: /\u2013/g, replace: '-' },
            { name: 'Points de suspension (‚Ä¶)', re: /\u2026/g, replace: '...' },
            { name: 'Ponctuation r√©p√©t√©e', re: /([!?]){2,}/g, replace: '$1' },
            { name: 'Espace ins√©cable', re: /\u00A0/g, replace: ' ' },
            { name: 'Espaces multiples', re: /[ \t]{2,}/g, replace: ' ' },
            { name: 'Lignes vides excessives', re: /\n{3,}/g, replace: '\n\n' },
            { name: 'Espaces en fin de ligne', re: /[ \t]+$/gm, replace: '' },
        ];

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        //  AI SCORE HEURISTIC
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function computeAIScore(text) {
            if (!text.trim()) return 0;
            let score = 0;
            const textLower = text.toLowerCase();
            const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 10);

            // Markdown presence
            score += Math.min((text.match(/[#*_`>|~]/g) || []).length * 2, 25);

            // AI phrase count
            let aiCount = 0;
            for (const r of aiPhraseRules) { const m = text.match(r.re); if (m) aiCount += m.length; }
            score += Math.min(aiCount * 5, 30);

            // Sentence uniformity
            if (sentences.length > 2) {
                const lengths = sentences.map(s => s.trim().split(/\s+/).length);
                const avg = lengths.reduce((a, b) => a + b, 0) / lengths.length;
                const stdDev = Math.sqrt(lengths.reduce((a, b) => a + Math.pow(b - avg, 2), 0) / lengths.length);
                score += stdDev < 4 ? 15 : stdDev < 8 ? 8 : 0;
            }

            // Transition words
            const transitions = ['furthermore', 'moreover', 'additionally', 'consequently', 'therefore',
                'nevertheless', 'nonetheless', 'accordingly', 'de plus', 'en outre', 'cependant',
                'n√©anmoins', 'toutefois', 'ainsi', 'par cons√©quent'];
            let tc = 0;
            for (const tw of transitions) tc += textLower.split(tw).length - 1;
            score += Math.min(tc * 4, 20);

            // Adverb density
            const adverbs = ['particularly', 'especially', 'significantly', 'effectively', 'efficiently',
                'remarkably', 'notably', 'importantly', 'crucially', 'essentially', 'fundamentally',
                'particuli√®rement', 'notamment', 'significativement', 'efficacement', 'remarquablement'];
            let ac = 0;
            for (const adv of adverbs) ac += textLower.split(adv).length - 1;
            score += Math.min(ac * 3, 15);

            // Typography chars
            score += Math.min((text.match(/[\u2014\u2013\u2026\u201C\u201D\u2018\u2019]/g) || []).length * 2, 10);

            return Math.min(Math.round(score), 100);
        }

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        //  PASS C ‚Äî AI VOCABULARY REPLACEMENT (increases perplexity)
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        const vocabRules = [
            { re: /\butilize[sd]?\b/gi, replace: 'use' },
            { re: /\bleverag(e[sd]?|ing)\b/gi, replace: 'use' },
            { re: /\bfacilitate[sd]?\b/gi, replace: 'help' },
            { re: /\bdelv(e[sd]?|ing)\b/gi, replace: 'look' },
            { re: /\bfoster(s|ed|ing)?\b/gi, replace: 'build' },
            { re: /\benhance[sd]?\b/gi, replace: 'improve' },
            { re: /\boptimize[sd]?\b/gi, replace: 'improve' },
            { re: /\bmaximize[sd]?\b/gi, replace: 'increase' },
            { re: /\bminimize[sd]?\b/gi, replace: 'reduce' },
            { re: /\bprioritize[sd]?\b/gi, replace: 'focus on' },
            { re: /\bstreamline[sd]?\b/gi, replace: 'simplify' },
            { re: /\bemphasize[sd]?\b/gi, replace: 'stress' },
            { re: /\bdemonstrate[sd]?\b/gi, replace: 'show' },
            { re: /\bexhibit[sd]?\b/gi, replace: 'show' },
            { re: /\bensure[sd]?\b/gi, replace: 'make sure' },
            { re: /\bcomprehensive\b/gi, replace: 'complete' },
            { re: /\brobust\b/gi, replace: 'strong' },
            { re: /\bseamless(ly)?\b/gi, replace: 'smooth' },
            { re: /\binnovative\b/gi, replace: 'new' },
            { re: /\bcutting-edge\b/gi, replace: 'modern' },
            { re: /\bstate-of-the-art\b/gi, replace: 'advanced' },
            { re: /\bgroundbreaking\b/gi, replace: 'new' },
            { re: /\bcrucial\b/gi, replace: 'key' },
            { re: /\bvital\b/gi, replace: 'important' },
            { re: /\bparamount\b/gi, replace: 'very important' },
            { re: /\bpivotal\b/gi, replace: 'central' },
            { re: /\bsubstantial(ly)?\b/gi, replace: 'large' },
            { re: /\bexceptional(ly)?\b/gi, replace: 'great' },
            { re: /\bextensive(ly)?\b/gi, replace: 'wide' },
            { re: /\beffectively\b/gi, replace: 'well' },
            { re: /\befficiently\b/gi, replace: 'well' },
            { re: /\bsignificantly\b/gi, replace: 'greatly' },
            { re: /\bparticularly\b/gi, replace: 'especially' },
            { re: /\bnotably\b/gi, replace: 'especially' },
            { re: /\bultimately\b/gi, replace: 'in the end' },
            { re: /\bfundamentally\b/gi, replace: 'basically' },
            { re: /\bessentially\b/gi, replace: 'basically' },
            { re: /\bprimarily\b/gi, replace: 'mainly' },
            { re: /\blandscape\b/gi, replace: 'field' },
            { re: /\becosystem\b/gi, replace: 'environment' },
            { re: /\bparadigm\b/gi, replace: 'model' },
            { re: /\bsynerg(y|ies)\b/gi, replace: 'cooperation' },
            { re: /\bmetrics\b/gi, replace: 'results' },
            { re: /\boutcomes\b/gi, replace: 'results' },
            { re: /\binsights\b/gi, replace: 'findings' },
            // Fran√ßais IA ‚Üí naturels
            { re: /\boptimiser\b/gi, replace: 'am√©liorer' },
            { re: /\bfaciliter\b/gi, replace: 'aider' },
            { re: /\bprivil√©gier\b/gi, replace: 'pr√©f√©rer' },
            { re: /\bpr√©conise[r]?\b/gi, replace: 'recommande' },
            { re: /\bcontribuer √†\b/gi, replace: 'aider √†' },
            { re: /\bpermettre de\b/gi, replace: 'aider √†' },
            { re: /\bconstitue[r]?\b/gi, replace: 'est' },
            { re: /\bnotamment\b/gi, replace: 'surtout' },
            { re: /\b√©galement\b/gi, replace: 'aussi' },
            { re: /\bainsi que\b/gi, replace: 'et' },
            { re: /\bafin de\b/gi, replace: 'pour' },
            { re: /\bdans le cadre de\b/gi, replace: 'dans' },
            { re: /\bau sein de\b/gi, replace: 'dans' },
            { re: /\b√† travers\b/gi, replace: 'via' },
            { re: /\ben mati√®re de\b/gi, replace: 'sur' },
            { re: /\bs'inscrire dans\b/gi, replace: 'faire partie de' },
        ];

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        //  PASS D ‚Äî PASSIVE ‚Üí ACTIVE VOICE
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        const passiveRules = [
            { re: /\bcan be (used|seen|found|done|made)\b/gi, replace: 'works' },
            { re: /\bis (used|seen|found|done|made) to\b/gi, replace: 'serves to' },
            { re: /\bwas (designed|built|created|developed) to\b/gi, replace: 'aims to' },
            { re: /\best (utilis√©|con√ßu|d√©velopp√©|cr√©√©) pour\b/gi, replace: 'sert √†' },
            { re: /\bpeut √™tre (utilis√©|vu|fait|appliqu√©)\b/gi, replace: 'fonctionne' },
            { re: /\bsont (utilis√©s|con√ßus|d√©velopp√©s|cr√©√©s) pour\b/gi, replace: 'servent √†' },
        ];

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        //  PASS E ‚Äî BURSTINESS VARIATION (sentence length)
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function varyBurstiness(text) {
            const sentenceRe = /([^.!?]+[.!?]+)/g;
            const sentences = [];
            let m, lastIdx = 0;
            while ((m = sentenceRe.exec(text)) !== null) {
                sentences.push(m[1]);
                lastIdx = sentenceRe.lastIndex;
            }
            if (lastIdx < text.length) sentences.push(text.slice(lastIdx));
            if (sentences.length < 3) return text;

            const result = [];
            let i = 0;
            while (i < sentences.length) {
                const s = sentences[i].trim();
                const words = s.split(/\s+/).filter(Boolean);

                // Long sentence (>28 words) ‚Üí split at conjunction after comma
                if (words.length > 28) {
                    const sp = s.search(/,\s+(et|mais|car|donc|or|ni|que|qui|o√π|parce que|puisque|bien que|and|but|because|so|which|that|since|although)\s/i);
                    if (sp > 0) {
                        const p1 = s.slice(0, sp).trim();
                        const p2 = s.slice(sp + 1).trim();
                        result.push(p1.match(/[.!?]$/) ? p1 : p1 + '.');
                        result.push(p2.charAt(0).toUpperCase() + p2.slice(1));
                        i++; continue;
                    }
                }

                // Two consecutive very short sentences (<6 words) ‚Üí merge
                if (words.length < 6 && i + 1 < sentences.length) {
                    const next = sentences[i + 1].trim();
                    if (next.split(/\s+/).filter(Boolean).length < 6) {
                        result.push(s.replace(/[.!?]+$/, '') + ', ' + next.charAt(0).toLowerCase() + next.slice(1));
                        i += 2; continue;
                    }
                }

                result.push(s);
                i++;
            }
            return result.join(' ');
        }

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        //  PASS E2 ‚Äî CONVERSATIONAL FILLER INJECTION
        //  Adds natural human-like openers to some sentences
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        const fillersFR = [
            'En fait,', 'Honn√™tement,', 'Pour √™tre franc,', '√Ä vrai dire,',
            'Concr√®tement,', 'Dans les faits,', 'En pratique,', 'Personnellement,',
            'Je dirais que', 'Ce qui est s√ªr,', 'Il faut dire que',
        ];
        const fillersEN = [
            'Honestly,', 'In practice,', 'To be fair,', 'Frankly,',
            'In reality,', 'Personally,', 'That said,', 'To put it simply,',
            'At the end of the day,', 'Truth be told,',
        ];

        function injectFillers(text) {
            // Detect language (simple heuristic)
            const frWords = (text.match(/\b(je|nous|vous|ils|elle|les|des|une|pour|dans|avec|sur|par)\b/gi) || []).length;
            const enWords = (text.match(/\b(the|and|for|with|this|that|have|from|they|will)\b/gi) || []).length;
            const chosen = frWords >= enWords ? fillersFR : fillersEN;

            // Inject filler at start of ~30% of sentences
            return text.replace(/([.!?]\s+)([A-Z√Ä√Ç√â√à√ä√ã√é√è√î√ô√õ√ú√á])/g, (match, punct, cap, offset) => {
                if (Math.random() > 0.30) return match;
                const filler = chosen[Math.floor(Math.random() * chosen.length)];
                // Avoid double filler
                if (text.slice(Math.max(0, offset - 40), offset).match(/Honn√™tement|En fait|Frankly|Honestly|√Ä vrai dire|Concr√®tement/)) return match;
                return punct + filler + ' ' + cap.toLowerCase();
            });
        }

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        //  PASS E3 ‚Äî ZERO-WIDTH CHARACTER INJECTION
        //  Inserts invisible Unicode chars to break AI tokenization
        //  Invisible to humans, disrupts detector token patterns
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        const ZW_CHARS = ['\u200B', '\u200C', '\u200D']; // ZWSP, ZWNJ, ZWJ

        function injectZeroWidth(text) {
            // Insert 1 zero-width char every ~8-15 word characters, randomly
            let result = '';
            let charCount = 0;
            let nextInject = 8 + Math.floor(Math.random() * 8);
            for (let i = 0; i < text.length; i++) {
                const ch = text[i];
                result += ch;
                // Only inject between word characters (not spaces or punctuation)
                if (/\w/.test(ch)) {
                    charCount++;
                    if (charCount >= nextInject) {
                        result += ZW_CHARS[Math.floor(Math.random() * ZW_CHARS.length)];
                        charCount = 0;
                        nextInject = 8 + Math.floor(Math.random() * 8);
                    }
                }
            }
            return result;
        }

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        //  PASS E4 ‚Äî HOMOGLYPH SUBSTITUTION
        //  Replaces ~15% of letters with visually identical Unicode chars
        //  Looks identical to humans, breaks character-level AI analysis
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        const homoglyphMap = {
            // Latin ‚Üí Cyrillic lookalikes
            'a': '\u0430', // Cyrillic –∞
            'e': '\u0435', // Cyrillic –µ
            'o': '\u043E', // Cyrillic –æ
            'p': '\u0440', // Cyrillic —Ä
            'c': '\u0441', // Cyrillic —Å
            'x': '\u0445', // Cyrillic —Ö
            'A': '\u0410', // Cyrillic –ê
            'E': '\u0415', // Cyrillic –ï
            'O': '\u041E', // Cyrillic –û
            'P': '\u0420', // Cyrillic –†
            'C': '\u0421', // Cyrillic –°
            'B': '\u0412', // Cyrillic –í
            'H': '\u041D', // Cyrillic –ù
            'K': '\u041A', // Cyrillic –ö
            'M': '\u041C', // Cyrillic –ú
            'T': '\u0422', // Cyrillic –¢
            'X': '\u0425', // Cyrillic –•
        };
        const homoglyphKeys = Object.keys(homoglyphMap);

        function applyHomoglyphs(text) {
            // Apply to ~15% of eligible characters
            return text.split('').map(ch => {
                if (homoglyphKeys.includes(ch) && Math.random() < 0.15) {
                    return homoglyphMap[ch];
                }
                return ch;
            }).join('');
        }

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        //  CLEAN ENGINE  (6 passes)
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function cleanText(raw) {
            let text = raw;
            const issues = [];
            let mdCount = 0, aiCount = 0, charCount = 0;

            // Pass A: Markdown removal
            for (const rule of markdownRules) {
                const before = text;
                text = text.replace(rule.re, rule.replace);
                if (before.length !== text.length) {
                    mdCount++;
                    issues.push({ name: rule.name, type: 'md', count: before.length - text.length });
                }
            }

            // Pass B: AI phrase removal
            for (const rule of aiPhraseRules) {
                const matches = text.match(rule.re);
                if (matches?.length) {
                    aiCount += matches.length;
                    issues.push({ name: rule.name, type: 'ai', count: matches.length });
                    text = text.replace(rule.re, rule.replace);
                }
            }

            // Pass C: AI vocabulary ‚Üí natural words (perplexity ‚Üë)
            for (const rule of vocabRules) {
                const before = text;
                text = text.replace(rule.re, rule.replace);
                if (before !== text) {
                    aiCount++;
                    issues.push({ name: 'üî§ Vocab IA ‚Üí naturel', type: 'ai', count: 1 });
                }
            }

            // Pass D: Passive ‚Üí active voice
            for (const rule of passiveRules) {
                const before = text;
                text = text.replace(rule.re, rule.replace);
                if (before !== text) issues.push({ name: 'üîÑ Voix passive ‚Üí active', type: 'ai', count: 1 });
            }

            // Pass E: Burstiness variation
            text = varyBurstiness(text);

            // Pass E2: Conversational filler injection (human rhythm)
            text = injectFillers(text);

            // Pass E3: Zero-width character injection (breaks AI tokenization)
            text = injectZeroWidth(text);

            // Pass E4: Homoglyph substitution (alters character-level signature)
            text = applyHomoglyphs(text);

            // Pass F: Character cleanup
            for (const rule of charRules) {
                const before = text;
                text = text.replace(rule.re, rule.replace);
                if (before.length !== text.length) {
                    charCount++;
                    issues.push({ name: rule.name, type: 'char', count: before.length - text.length });
                }
            }

            // Fix capitalization after removals
            text = text.replace(/([.!?]\s+)([a-z√†√¢√©√®√™√´√Æ√Ø√¥√π√ª√º√ß])/g, (m, p1, p2) => p1 + p2.toUpperCase());
            text = text.replace(/  +/g, ' ').trim();

            return { cleaned: text, issues, mdCount, aiCount, charCount };
        }

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        //  UI STATE
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        let lastRaw = '';
        let lastCleaned = '';
        let debounceTimer = null;

        function onInput() {
            const raw = document.getElementById('inputText').value;
            document.getElementById('inputCharCount').textContent = raw.length.toLocaleString('fr-FR') + ' car.';

            if (raw === lastRaw) return;
            lastRaw = raw;

            if (!raw.trim()) { resetUI(); return; }

            // Show processing overlay with debounce
            clearTimeout(debounceTimer);
            document.getElementById('processingOverlay').classList.add('active');

            debounceTimer = setTimeout(() => {
                const t0 = performance.now();
                const scoreBefore = computeAIScore(raw);
                const { cleaned, issues, mdCount, aiCount, charCount } = cleanText(raw);
                const scoreAfter = computeAIScore(cleaned);
                const elapsed = Math.round(performance.now() - t0);
                lastCleaned = cleaned;

                // Hide overlay
                document.getElementById('processingOverlay').classList.remove('active');

                // Output
                const outputEl = document.getElementById('outputText');
                document.getElementById('emptyState')?.remove();
                outputEl.textContent = cleaned;
                document.getElementById('outputCharCount').textContent = cleaned.length.toLocaleString('fr-FR') + ' car.';

                // Stats
                document.getElementById('statMd').textContent = mdCount;
                document.getElementById('statAi').textContent = aiCount;
                document.getElementById('statChars').textContent = (raw.length - cleaned.length).toLocaleString('fr-FR');
                document.getElementById('statWords').textContent = cleaned.split(/\s+/).filter(Boolean).length.toLocaleString('fr-FR');

                // Score bars
                document.getElementById('scoreBefore').style.width = scoreBefore + '%';
                document.getElementById('scoreBeforeVal').textContent = scoreBefore + '%';
                document.getElementById('scoreAfter').style.width = scoreAfter + '%';
                document.getElementById('scoreAfterVal').textContent = scoreAfter + '%';

                // Timer badge
                const timerBadge = document.getElementById('timerBadge');
                timerBadge.classList.remove('hidden');
                timerBadge.classList.add('flex');
                document.getElementById('timerVal').textContent = elapsed < 1000 ? elapsed + 'ms' : (elapsed / 1000).toFixed(2) + 's';

                // Issues
                const grid = document.getElementById('issuesGrid');
                if (issues.length === 0) {
                    grid.innerHTML = '<div class="text-xs text-green-400 font-medium">‚úÖ Aucun probl√®me d√©tect√© ‚Äî texte d√©j√† propre !</div>';
                } else {
                    const typeColors = {
                        md: 'bg-yellow-500/10 border-yellow-500/30 text-yellow-400',
                        ai: 'bg-pink-500/10 border-pink-500/30 text-pink-400',
                        char: 'bg-brand-500/10 border-brand-500/30 text-brand-400',
                    };
                    grid.innerHTML = issues.map((issue, i) => `
        <div class="issue-tag flex items-center gap-1.5 border rounded-lg px-2.5 py-1 text-xs ${typeColors[issue.type]}"
             style="animation-delay:${i * 30}ms">
          <span class="font-bold bg-current text-gray-950 rounded px-1.5 py-0.5 text-xs leading-none">${issue.count}</span>
          ${issue.name}
        </div>
      `).join('');
                }
            }, 180); // 180ms debounce = feels instant but avoids thrashing
        }

        function resetUI() {
            document.getElementById('processingOverlay').classList.remove('active');
            const outputEl = document.getElementById('outputText');
            outputEl.innerHTML = `
    <div id="emptyState" class="h-full flex flex-col items-center justify-center gap-3 text-center">
      <div class="text-5xl opacity-20">üßπ</div>
      <p class="text-sm" style="color:var(--text-dim)">Le texte nettoy√© appara√Ætra ici‚Ä¶</p>
      <p class="text-xs" style="color:var(--text-dimmer)">Collez votre texte dans le panneau de gauche</p>
    </div>`;
            ['statMd', 'statAi', 'statChars', 'statWords'].forEach(id => document.getElementById(id).textContent = '0');
            document.getElementById('scoreBefore').style.width = '0%';
            document.getElementById('scoreBeforeVal').textContent = '‚Äî';
            document.getElementById('scoreAfter').style.width = '0%';
            document.getElementById('scoreAfterVal').textContent = '‚Äî';
            document.getElementById('outputCharCount').textContent = '0 car.';
            document.getElementById('timerBadge').classList.add('hidden');
            document.getElementById('timerBadge').classList.remove('flex');
            document.getElementById('issuesGrid').innerHTML = '<div class="text-xs italic" style="color:var(--text-dim)">Collez un texte pour voir l\'analyse d√©taill√©e‚Ä¶</div>';
            lastRaw = ''; lastCleaned = '';
        }

        function clearInput() {
            document.getElementById('inputText').value = '';
            document.getElementById('inputCharCount').textContent = '0 car.';
            resetUI();
        }

        async function copyOutput() {
            if (!lastCleaned) return;
            try {
                await navigator.clipboard.writeText(lastCleaned);
            } catch {
                const ta = document.createElement('textarea');
                ta.value = lastCleaned;
                document.body.appendChild(ta);
                ta.select();
                document.execCommand('copy');
                document.body.removeChild(ta);
            }
            const toast = document.getElementById('toast');
            toast.classList.remove('translate-y-20', 'opacity-0');
            toast.classList.add('translate-y-0', 'opacity-100');
            setTimeout(() => {
                toast.classList.add('translate-y-20', 'opacity-0');
                toast.classList.remove('translate-y-0', 'opacity-100');
            }, 2500);
        }

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        //  THEME TOGGLE
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        let isDark = true;
        function toggleTheme() {
            isDark = !isDark;
            document.body.classList.toggle('light', !isDark);
            document.getElementById('themeToggle').classList.toggle('on', isDark);
        }

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        //  KEYBOARD SHORTCUT  Ctrl+Enter = copy
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        document.addEventListener('keydown', e => {
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') copyOutput();
        });

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        //  WELCOME MODAL & STUDENT PROFILE
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        (function initStudent() {
            const nom = localStorage.getItem('cps_nom');
            const promo = localStorage.getItem('cps_promo');

            if (!nom) {
                // First visit ‚Äî show modal
                showWelcomeModal();
            } else {
                // Returning student ‚Äî show greeting banner
                showGreeting(nom, promo);
            }
        })();

        function showWelcomeModal() {
            const overlay = document.getElementById('welcomeOverlay');
            overlay.style.display = 'flex';
            spawnParticles();
            // Focus first input after animation
            setTimeout(() => document.getElementById('inputNom').focus(), 700);
        }

        function saveStudent() {
            const nom = document.getElementById('inputNom').value.trim();
            const promo = document.getElementById('inputPromo').value;
            if (!nom) {
                document.getElementById('inputNom').style.borderColor = 'rgba(239,68,68,0.8)';
                document.getElementById('inputNom').style.boxShadow = '0 0 0 3px rgba(239,68,68,0.15)';
                document.getElementById('inputNom').placeholder = '‚ö†Ô∏è Entre ton pr√©nom !';
                return;
            }
            const nomFormatted = nom.charAt(0).toUpperCase() + nom.slice(1).toLowerCase();
            localStorage.setItem('cps_nom', nomFormatted);
            localStorage.setItem('cps_promo', promo || 'CPS');
            // Animate out
            const card = document.getElementById('welcomeCard');
            card.style.animation = 'welcomeOut 0.4s cubic-bezier(0.4,0,1,1) forwards';
            setTimeout(() => {
                document.getElementById('welcomeOverlay').style.display = 'none';
                showGreeting(nomFormatted, promo || 'CPS');
            }, 400);
        }

        function showGreeting(nom, promo) {
            const hour = new Date().getHours();
            let salut;
            if (hour >= 5 && hour < 12) salut = 'Bonjour';
            else if (hour >= 12 && hour < 18) salut = 'Bon apr√®s-midi';
            else salut = 'Bonsoir';

            const banner = document.getElementById('greetingBanner');
            const text = document.getElementById('greetingText');
            text.innerHTML = `üëã ${salut} <strong style="color:#a08fff">${nom}</strong>${promo ? ` ¬∑ <span style="color:#f5a623;font-size:0.75rem">${promo}</span>` : ''} ‚Äî Bonne session de nettoyage ! üöÄ`;
            banner.classList.remove('hidden');
            // Push content down slightly
            document.body.style.paddingTop = banner.offsetHeight + 'px';
            setTimeout(() => document.body.style.paddingTop = '', 4000);
        }

        function spawnParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 30; i++) {
                const p = document.createElement('div');
                const size = Math.random() * 6 + 2;
                const x = Math.random() * 100;
                const dur = Math.random() * 8 + 4;
                const del = Math.random() * 4;
                p.style.cssText = `
                    position:absolute;
                    width:${size}px;height:${size}px;
                    left:${x}%;bottom:-10px;
                    border-radius:50%;
                    background:rgba(${Math.random() > 0.5 ? '108,63,255' : '160,143,255'},${Math.random() * 0.6 + 0.2});
                    animation:floatUp ${dur}s ${del}s ease-in infinite;
                    pointer-events:none;
                `;
                container.appendChild(p);
            }
        }

        // Enter key submits the modal form
        document.addEventListener('keydown', e => {
            if (e.key === 'Enter' && document.getElementById('welcomeOverlay').style.display !== 'none') {
                saveStudent();
            }
        });
    </script>

    <style>
        @keyframes welcomeIn {
            from {
                opacity: 0;
                transform: scale(0.85) translateY(30px);
            }

            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        @keyframes welcomeOut {
            from {
                opacity: 1;
                transform: scale(1) translateY(0);
            }

            to {
                opacity: 0;
                transform: scale(0.9) translateY(-20px);
            }
        }

        @keyframes floatUp {
            0% {
                transform: translateY(0) scale(1);
                opacity: 0;
            }

            10% {
                opacity: 1;
            }

            90% {
                opacity: 0.5;
            }

            100% {
                transform: translateY(-100vh) scale(0.5);
                opacity: 0;
            }
        }

        #inputNom::placeholder {
            color: rgba(156, 163, 175, 0.5);
        }

        #inputPromo option {
            color: #f3f4f6;
        }
    </style>
</body>

</html>